# –°–∫—Ä–∏–ø—Ç —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –∏–≥—Ä–æ–∫–æ–≤ BP —Å BTR

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç `link_bp_btr_players.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç –∏–≥—Ä–æ–∫–æ–≤ –∏–∑ —Å–∏—Å—Ç–µ–º—ã BP (BeachPoints) —Å –∏–≥—Ä–æ–∫–∞–º–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã BTR (BeachTennisRussia) –ø–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é **–§–∞–º–∏–ª–∏—è + –ò–º—è**.

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. **–ü–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π**: –ò—â–µ—Ç –∏–≥—Ä–æ–∫–æ–≤ BTR —Å —Ç–æ—á–Ω–æ —Ç–∞–∫–æ–π –∂–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π –§–∞–º–∏–ª–∏—è+–ò–º—è (—Ä–µ–≥–∏—Å—Ç—Ä –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è)
2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–≤—è–∑–∏**: –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω **—Ä–æ–≤–Ω–æ –æ–¥–∏–Ω** BTR –∏–≥—Ä–æ–∫ - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–≤—è–∑—å —á–µ—Ä–µ–∑ –ø–æ–ª–µ `btr_player_id` –≤ –º–æ–¥–µ–ª–∏ `Player`
3. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è**: –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ **–Ω–µ—Å–∫–æ–ª—å–∫–æ** BTR –∏–≥—Ä–æ–∫–æ–≤ - –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
4. **–ü—Ä–æ–ø—É—Å–∫ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö**: –ï—Å–ª–∏ `btr_player_id` —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω - –∏–≥—Ä–æ–∫ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
# –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
python scripts/link_bp_btr_players.py
```

### –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

```bash
python scripts/link_bp_btr_players.py --dry-run
```

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è **–≤—Å–µ–≥–¥–∞** —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ!

### –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥

```bash
python scripts/link_bp_btr_players.py --verbose
```

### –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ñ–ª–∞–≥–æ–≤

```bash
python scripts/link_bp_btr_players.py --dry-run --verbose
```

## –ü—Ä–∏–º–µ—Ä—ã –≤—ã–≤–æ–¥–∞

### –£—Å–ø–µ—à–Ω–∞—è —Å–≤—è–∑–∫–∞

```
‚úÖ –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω (BP #123) ‚Üí –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω (BTR #456, –†–ù–ò: 12345)
```

### –ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ BTR

```
‚ùå –ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä - –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ BTR
```

### –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

```
‚ö†Ô∏è  –°–∏–¥–æ—Ä–æ–≤ –°–µ—Ä–≥–µ–π (BP #789) - –Ω–∞–π–¥–µ–Ω–æ 2 —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –≤ BTR:
    - BTR #101: –°–∏–¥–æ—Ä–æ–≤ –°–µ—Ä–≥–µ–π, –†–ù–ò: 11111, –ì–æ—Ä–æ–¥: –ú–æ—Å–∫–≤–∞, –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: 1990-05-15
    - BTR #102: –°–∏–¥–æ—Ä–æ–≤ –°–µ—Ä–≥–µ–π, –†–ù–ò: 22222, –ì–æ—Ä–æ–¥: –ö–∞–∑–∞–Ω—å, –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: 1995-08-20
```

## –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∏—Ç:

```
üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê
================================================================================
–í—Å–µ–≥–æ BP –∏–≥—Ä–æ–∫–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ:     150
–£–∂–µ —Å–≤—è–∑–∞–Ω—ã (btr_player_id):     45
‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–≤—è–∑–∞–Ω—ã:              80
‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω—ã –≤ BTR:             15
‚ö†Ô∏è  –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π:         10
‚ùó –û—à–∏–±–∫–∏:                        0
```

## –û—Ç—á—ë—Ç

–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ (–Ω–µ –≤ `--dry-run` —Ä–µ–∂–∏–º–µ) —Å–æ–∑–¥–∞—ë—Ç—Å—è JSON —Ñ–∞–π–ª —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ—Ç—á—ë—Ç–æ–º:

```
link_bp_btr_report_20241125_210000.json
```

–°–æ–¥–µ—Ä–∂–∏—Ç:
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –°–ø–∏—Å–æ–∫ —É—Å–ø–µ—à–Ω–æ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏

## –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

–î–ª—è –∏–≥—Ä–æ–∫–æ–≤ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏ –Ω—É–∂–Ω–æ:

1. –û—Ç–∫—Ä—ã—Ç—å –æ—Ç—á—ë—Ç –∏–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—ã–≤–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ BTR –∏–≥—Ä–æ–∫–∞ –ø–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º:
   - –ì–æ—Ä–æ–¥
   - –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
   - –ò—Å—Ç–æ—Ä–∏—è —Ç—É—Ä–Ω–∏—Ä–æ–≤
3. –í—Ä—É—á–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤—è–∑—å –≤ –∞–¥–º–∏–Ω–∫–µ Django –∏–ª–∏ —á–µ—Ä–µ–∑ SQL:

```sql
UPDATE players_player 
SET btr_player_id = 456 
WHERE id = 123;
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –°–∫—Ä–∏–ø—Ç **–ù–ï –∏–∑–º–µ–Ω—è–µ—Ç** —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–≤—è–∑–∏ (–µ—Å–ª–∏ `btr_player_id` —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
- ‚úÖ –°–∫—Ä–∏–ø—Ç **–ù–ï —Å–≤—è–∑—ã–≤–∞–µ—Ç** –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è—Ö
- ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º `--dry-run` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –°–æ–∑–¥–∞—ë—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –¥–ª—è –∞—É–¥–∏—Ç–∞

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π workflow

1. **–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º:**
   ```bash
   python scripts/link_bp_btr_players.py --dry-run --verbose
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** - —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–≤—è–∑–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

3. **–†–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫:**
   ```bash
   python scripts/link_bp_btr_players.py
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—á—ë—Ç–∞** - –∏–∑—É—á–∏—Ç—å JSON —Ñ–∞–π–ª

5. **–†—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

## –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫

–°–∫—Ä–∏–ø—Ç –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ:
- –£–∂–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã
- –ù–æ–≤—ã–µ –∏–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- Django –ø—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- –î–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ú–æ–¥–µ–ª–∏ `Player` (BP) –∏ `BtrPlayer` (BTR)

## Troubleshooting

### –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ Django

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
cd /path/to/SandMatch
python scripts/link_bp_btr_players.py
```

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `sandmatch/settings.py`

### –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ñ–ª–∞–≥ `--dry-run`

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ cron –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:

```bash
# –ö–∞–∂–¥—É—é –Ω–æ—á—å –≤ 3:00
0 3 * * * cd /path/to/SandMatch && python scripts/link_bp_btr_players.py >> /var/log/link_players.log 2>&1
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å —Ñ–ª–∞–≥–æ–º `--verbose`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ JSON –æ—Ç—á—ë—Ç
3. –ò–∑—É—á–∏—Ç–µ –ª–æ–≥–∏ Django
